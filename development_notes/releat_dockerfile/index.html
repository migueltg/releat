
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Reinforcement Learning for Algorithmic Trading">
      
      
        <meta name="author" content="releat215">
      
      
      
        <link rel="prev" href="../../examples/eval_rl_agent_simple/">
      
      
        <link rel="next" href="../../troubleshooting/troubleshooting/">
      
      
      <link rel="icon" href="../../images/logo-1.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.1">
    
    
      
        <title>Containerisation - ReLeAT</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#building-the-releat-dockerfile" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ReLeAT" class="md-header__button md-logo" aria-label="ReLeAT" data-md-component="logo">
      
  <img src="../../images/logo-1.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ReLeAT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Containerisation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/releat215/releat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    releat215/releat
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting_started/installation/" class="md-tabs__link">
          
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/mt5_api_data_extract/" class="md-tabs__link">
          
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  Development Notes

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../troubleshooting/troubleshooting/" class="md-tabs__link">
        
  
    
  
  Troubleshooting

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ReLeAT" class="md-nav__button md-logo" aria-label="ReLeAT" data-md-component="logo">
      
  <img src="../../images/logo-1.png" alt="logo">

    </a>
    ReLeAT
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/releat215/releat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    releat215/releat
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/basic_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mt5_api_data_extract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data extraction via MT5 api
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/make_gradient_feature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Make gradient feature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/eval_rl_agent_simple/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluate simple RL agent (t00001)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Containerisation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Containerisation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-points" class="md-nav__link">
    Key Points
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-considerations" class="md-nav__link">
    Design Considerations
  </a>
  
    <nav class="md-nav" aria-label="Design Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base-layer" class="md-nav__link">
    Base layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wine" class="md-nav__link">
    Wine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conda-and-poetry" class="md-nav__link">
    Conda and Poetry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aerospike" class="md-nav__link">
    Aerospike
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entrypoint" class="md-nav__link">
    Entrypoint
  </a>
  
    <nav class="md-nav" aria-label="Entrypoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entrypoint-logic" class="md-nav__link">
    Entrypoint logic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-python-environment" class="md-nav__link">
    Linux python environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wine-packages" class="md-nav__link">
    Wine packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#side-notes" class="md-nav__link">
    Side notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-container" class="md-nav__link">
    Building the Container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-container" class="md-nav__link">
    Running the Container
  </a>
  
    <nav class="md-nav" aria-label="Running the Container">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vscode-devcontainer" class="md-nav__link">
    VSCode devcontainer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-run" class="md-nav__link">
    docker run
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-points" class="md-nav__link">
    Key Points
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-considerations" class="md-nav__link">
    Design Considerations
  </a>
  
    <nav class="md-nav" aria-label="Design Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base-layer" class="md-nav__link">
    Base layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wine" class="md-nav__link">
    Wine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conda-and-poetry" class="md-nav__link">
    Conda and Poetry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aerospike" class="md-nav__link">
    Aerospike
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entrypoint" class="md-nav__link">
    Entrypoint
  </a>
  
    <nav class="md-nav" aria-label="Entrypoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entrypoint-logic" class="md-nav__link">
    Entrypoint logic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-python-environment" class="md-nav__link">
    Linux python environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wine-packages" class="md-nav__link">
    Wine packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#side-notes" class="md-nav__link">
    Side notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-container" class="md-nav__link">
    Building the Container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-container" class="md-nav__link">
    Running the Container
  </a>
  
    <nav class="md-nav" aria-label="Running the Container">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vscode-devcontainer" class="md-nav__link">
    VSCode devcontainer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-run" class="md-nav__link">
    docker run
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="building-the-releat-dockerfile">Building the ReLeAT DockerFile<a class="headerlink" href="#building-the-releat-dockerfile" title="Permanent link">&para;</a></h1>
<p>Summary of design considerations for the Dockerfile that has the following features:</p>
<ul>
<li>Install and run MetaTrader5 and python in wine</li>
<li>Rllib in linux container with Nividia GPU enabled</li>
<li>Poetry to manage package dependency</li>
<li>Aerospike as databse tool</li>
</ul>
<h2 id="key-points">Key Points<a class="headerlink" href="#key-points" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Check aerospike versions because they tend to be updated quite frequently</p>
</li>
<li>
<p>User the repo folder as the context when building and running</p>
</li>
<li>
<p>On first start up of MetaTrader5, you need to manually click on the 'Accounts' button to allow it to connect to broker servers. After logging in you need to manually click the 'Allow Autotrading' button - slightly weird behaviour from running MetaTrader5 on wine.</p>
</li>
<li>
<p>Future work - updating packages to latest version</p>
</li>
</ul>
<h2 id="design-considerations">Design Considerations<a class="headerlink" href="#design-considerations" title="Permanent link">&para;</a></h2>
<h3 id="base-layer">Base layer<a class="headerlink" href="#base-layer" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Ubuntu 20.04 was used as the base image - could upgrade in the future.</p>
</li>
<li>
<p><code>DEBIAN_FRONTEND=noninteractive</code> to accept all default options when installing and
removing software (i.e. apt-get install). This prevents questions from blocking
the installation process</p>
</li>
<li>
<p>Set environment paths so that Miniconda, MetaTrader5 and python environments
are saved in the correct place and/or easily searchable.</p>
</li>
<li>
<p><code>MT5_PATH</code> is saved as an environment variable because the entrypoint script
check whether this file exists. If not, then it will install MT5</p>
</li>
<li>
<p>Set environment display to 0 to pass through screen. Not sure if this is necessary.
But some wine windows apps (i.e. Python and MetaTrader5) cannot be installed headlessly</p>
</li>
<li>
<p>Tensorflow version is set to 2.11.0 - could be upgraded in the future</p>
</li>
<li>
<p>Python version is set to 2.10.10 - couldn't upgrade this to 2.11 because at the time,
the aerospike python package and rllib was incompatible / not stable</p>
</li>
</ul>
<div class="no-copy codehilite"><pre><span></span><code>FROM<span class="w"> </span>ubuntu:focal

ENV<span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
ENV<span class="w"> </span><span class="nv">TZ</span><span class="o">=</span>Etc/UTC

ENV<span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:/root/miniconda3/bin:/root/.local/bin&quot;</span>
<span class="c1"># Location of linux python env</span>
ENV<span class="w"> </span><span class="nv">PY_PATH</span><span class="o">=</span><span class="s2">&quot;./.venv&quot;</span>
<span class="c1"># Metatrader path</span>
ENV<span class="w"> </span><span class="nv">MT5_PATH</span><span class="o">=</span><span class="s2">&quot;/root/.wine/drive_c/Program Files/MetaTrader 5/terminal64.exe&quot;</span>

ENV<span class="w"> </span>DISPLAY<span class="w"> </span>:0

<span class="c1"># Tensorflow version</span>
ENV<span class="w"> </span><span class="nv">TF_V</span><span class="o">=</span><span class="s2">&quot;2.11.0&quot;</span>
<span class="c1"># Python version</span>
ENV<span class="w"> </span><span class="nv">PY_V</span><span class="o">=</span><span class="s2">&quot;3.10.10&quot;</span>
</code></pre></div>

<h3 id="wine">Wine<a class="headerlink" href="#wine" title="Permanent link">&para;</a></h3>
<p>Wine enables the running of Windows software on Linux systems.
For other options, see this guideline for <a href="https://wiki.archlinux.org/title/Wine_package_guidelines">installing and running wine</a>.</p>
<ul>
<li>
<p><code>WINEDLLOVERRIDES="mscoree,mshtml="</code> <a href="https://forum.winehq.org/viewtopic.php?t=16320">disables the Mono installer dialog</a> allowing it to
be installed in the Dockerfile headlessly instead of in the entrypoint script.</p>
</li>
<li>
<p><code>WINEDEBUG="fixme-all,err-all"</code> suppresses most of the warnings, reducing log volume</p>
</li>
<li>
<p><code>WINEPREFIX="/root/.wine"</code> helps processes find the installation location of wine</p>
</li>
<li>
<p><code>dpkg --add-architecture i386</code> enables the installation of multiarch binaries</p>
</li>
<li>
<p>install development version of wine - could also use stable</p>
</li>
<li>
<p><code>winecfg -v win10</code> sets the windows 10, necessary for python and MT5</p>
</li>
<li>
<p><code>wineserver -w</code> waits until currently running wineserver terminates. Not sure if
this is necessary</p>
</li>
</ul>
<div class="no-copy codehilite"><pre><span></span><code><span class="c1"># Wine configs</span>
ENV<span class="w"> </span><span class="nv">WINEDLLOVERRIDES</span><span class="o">=</span><span class="s2">&quot;mscoree,mshtml=&quot;</span>
ENV<span class="w"> </span><span class="nv">WINEDEBUG</span><span class="o">=</span><span class="s2">&quot;fixme-all,err-all&quot;</span>
ENV<span class="w"> </span><span class="nv">WINEPREFIX</span><span class="o">=</span><span class="s2">&quot;/root/.wine&quot;</span>


<span class="c1"># Install wine</span>
RUN<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>wget<span class="w"> </span>gnupg2<span class="w"> </span>dialog<span class="w"> </span>apt-utils<span class="w"> </span>software-properties-common<span class="w"> </span>curl<span class="w"> </span>make<span class="w"> </span>git<span class="w"> </span>tzdata<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>dpkg<span class="w"> </span>--add-architecture<span class="w"> </span>i386<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>-pm755<span class="w"> </span>/etc/apt/keyrings<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>/etc/apt/keyrings/winehq-archive.key<span class="w"> </span>https://dl.winehq.org/wine-builds/winehq.key<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>-nc<span class="w"> </span>https://dl.winehq.org/wine-builds/ubuntu/dists/focal/winehq-focal.sources<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>mv<span class="w"> </span>winehq-focal.sources<span class="w"> </span>/etc/apt/sources.list.d/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--install-recommends<span class="w"> </span>winehq-devel<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>remove<span class="w"> </span>-y<span class="w"> </span>winbind<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>winbind<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*<span class="w"> </span>/winehq.key<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>winecfg<span class="w"> </span>-v<span class="w"> </span>win10<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wineserver<span class="w"> </span>-w
</code></pre></div>

<p>Install mono and gecko, wine packages that a necessary to make windows applications
work. Depending on what version of wine is installed, install the appropriate
<a href="https://wiki.winehq.org/Mono">mono version</a> and <a href="https://wiki.winehq.org/Gecko">gecko version</a>. Reboot and remove installation files once
installed</p>
<div class="no-copy codehilite"><pre><span></span><code><span class="c1"># Install wine mono and gecko</span>
RUN<span class="w"> </span>wget<span class="w"> </span>https://dl.winehq.org/wine/wine-mono/8.0.0/wine-mono-8.0.0-x86.msi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>https://dl.winehq.org/wine/wine-gecko/2.47.4/wine-gecko-2.47.4-x86.msi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>https://dl.winehq.org/wine/wine-gecko/2.47.4/wine-gecko-2.47.4-x86_64.msi<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wineboot<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>wine-mono-8.0.0-x86.msi<span class="w"> </span>/quiet<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>wine-gecko-2.47.4-x86.msi<span class="w"> </span>/quiet<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>wine-gecko-2.47.4-x86_64.msi<span class="w"> </span>/quiet<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>wine-mono-8.0.0-x86.msi<span class="w"> </span>wine-gecko-2.47.4-x86.msi<span class="w"> </span>wine-gecko-2.47.4-x86_64.msi
</code></pre></div>

<h3 id="conda-and-poetry">Conda and Poetry<a class="headerlink" href="#conda-and-poetry" title="Permanent link">&para;</a></h3>
<p>Miniconda and poetry for manage python packages. <a href="https://stackoverflow.com/questions/70851048/does-it-make-sense-to-use-conda-poetry">Both are required</a>
because of GPU. Miniconda is used to install nvidia packages whilst poetry is for pure
python. <code>eval "$(conda shell.bash hook)"</code> sets up shell functions for Conda.</p>
<div class="no-copy codehilite"><pre><span></span><code><span class="c1"># Install Miniconda and Poetry</span>
RUN<span class="w"> </span>wget<span class="w"> </span>https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>/root/.conda<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>bash<span class="w"> </span>Miniconda3-latest-Linux-x86_64.sh<span class="w"> </span>-b<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>Miniconda3-latest-Linux-x86_64.sh<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">eval</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>conda<span class="w"> </span>shell.bash<span class="w"> </span>hook<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>curl<span class="w"> </span>-sSL<span class="w"> </span>https://install.python-poetry.org<span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-
</code></pre></div>

<h3 id="aerospike">Aerospike<a class="headerlink" href="#aerospike" title="Permanent link">&para;</a></h3>
<p><a href="https://aerospike.com/">Aerospike</a> is a real-time in memory database, which will be used to for storing
observations for the reinforment learning training process. This is installed last
because version are updated frequently, so we only need to rebuild the last layer.</p>
<p>Note: check aerospike versions regularly</p>
<div class="no-copy codehilite"><pre><span></span><code><span class="c1"># aerospike server version</span>
ARG<span class="w"> </span><span class="nv">AS_V</span><span class="o">=</span><span class="s2">&quot;6.4.0.1&quot;</span>
<span class="c1"># aerospike tool version</span>
ARG<span class="w"> </span><span class="nv">AT_V</span><span class="o">=</span><span class="s2">&quot;9.0.0&quot;</span>
<span class="c1"># Installing aerospike</span>
RUN<span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>aerospike.tgz<span class="w"> </span>https://download.aerospike.com/artifacts/aerospike-server-community/<span class="si">${</span><span class="nv">AS_V</span><span class="si">}</span>/aerospike-server-community_<span class="si">${</span><span class="nv">AS_V</span><span class="si">}</span>_tools-<span class="si">${</span><span class="nv">AT_V</span><span class="si">}</span>_ubuntu20.04_x86_64.tgz<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>tar<span class="w"> </span>-xvf<span class="w"> </span>aerospike.tgz<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>aerospike-server-community_<span class="si">${</span><span class="nv">AS_V</span><span class="si">}</span>_tools-<span class="si">${</span><span class="nv">AT_V</span><span class="si">}</span>_ubuntu20.04_x86_64<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>./asinstall<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>aerospike.tgz

ENTRYPOINT<span class="w"> </span><span class="o">[</span><span class="s2">&quot;/bin/bash&quot;</span><span class="o">]</span>
</code></pre></div>

<h2 id="entrypoint">Entrypoint<a class="headerlink" href="#entrypoint" title="Permanent link">&para;</a></h2>
<p>The default entrypoint is the bash terminal. An entrypoint script is included in that folder and run depending on how you plan on accessing the container. The next section explains each component of the entrypoint script, followed by the different ways to <a href="#building-the-container">build</a> and <a href="#running-the-container">run</a> the container</p>
<h3 id="entrypoint-logic">Entrypoint logic<a class="headerlink" href="#entrypoint-logic" title="Permanent link">&para;</a></h3>
<ul>
<li><code>#!/bin/bash</code> - when using VSCode's devcontainer functionality must use bash because
sh doesn't work, not sure why</li>
</ul>
<h3 id="linux-python-environment">Linux python environment<a class="headerlink" href="#linux-python-environment" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>check if <code>./.venv</code> folder already exists, if so we can skip the installation of
python libraries</p>
</li>
<li>
<p>Create python environment. Note this is done in entrypoint rather than Dockerfile
so that the installed files are in the same location as the repo within the binded mount.
Works well for developing in VSCode's devcontainer, need to test more when using other
IDEs.</p>
</li>
<li>
<p>Currently we're still using an old version of tensorflow - see notes below for future
version for python</p>
</li>
<li>
<p>For GPU usage, we need conda to install cuda packages. Then everything else can be
installed by pip</p>
</li>
<li>
<p>Make sure to lock tensorflow version in poetry lock file, then install all other
packages using poetry</p>
</li>
</ul>
<div class="no-copy codehilite"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;./.venv&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Conda environments installed&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;install linux packages&quot;</span>
<span class="w">    </span>conda<span class="w"> </span>create<span class="w"> </span>--prefix<span class="w"> </span><span class="si">${</span><span class="nv">PY_PATH</span><span class="si">}</span><span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="si">${</span><span class="nv">PY_V</span><span class="si">}</span><span class="w"> </span>-y
<span class="w">    </span><span class="nb">eval</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>conda<span class="w"> </span>shell.bash<span class="w"> </span>hook<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span>conda<span class="w"> </span>activate<span class="w"> </span><span class="si">${</span><span class="nv">PY_PATH</span><span class="si">}</span>

<span class="w">    </span><span class="c1"># Install linux tensorflow=2.11.0</span>
<span class="w">    </span>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="nv">cudatoolkit</span><span class="o">=</span><span class="m">11</span>.2.2<span class="w"> </span><span class="nv">cudnn</span><span class="o">=</span><span class="m">8</span>.1.0<span class="w"> </span>-y
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:<span class="nv">$CONDA_PREFIX</span>/lib/
<span class="w">    </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$CONDA_PREFIX</span>/etc/conda/activate.d
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$CONDA_PREFIX/lib/&#39;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$CONDA_PREFIX</span>/etc/conda/activate.d/env_vars.sh<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>/content/conda-env/lib:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
<span class="w">    </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
<span class="w">    </span>pip<span class="w"> </span>install<span class="w"> </span><span class="nv">tensorflow</span><span class="o">==</span><span class="si">${</span><span class="nv">TF_V</span><span class="si">}</span>

<span class="w">    </span><span class="c1"># Install linux python packages</span>
<span class="w">    </span>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>anaconda<span class="w"> </span>-y
<span class="w">    </span>poetry<span class="w"> </span>init<span class="w"> </span>--python<span class="o">=</span>~<span class="si">${</span><span class="nv">PY_V</span><span class="si">}</span>
<span class="w">    </span>poetry<span class="w"> </span>add<span class="w"> </span>--lock<span class="w"> </span><span class="nv">tensorflow</span><span class="o">=</span><span class="si">${</span><span class="nv">TF_V</span><span class="si">}</span>
<span class="w">    </span>poetry<span class="w"> </span>install<span class="w"> </span>--with<span class="w"> </span>rl
<span class="w">    </span>pre-commit<span class="w"> </span>install

<span class="k">fi</span>
</code></pre></div>

<h3 id="wine-packages">Wine packages<a class="headerlink" href="#wine-packages" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Install same version of python in wine. We need this to programmatically extract
data and trade in MT5</p>
</li>
<li>
<p>Install python packages via poetry, note this means that when we deploy tensorflow
models, we will be using cpu version only. Currently designed to be a monolith to
simplify networking between applications / container. Might look at a
microservice design in the future</p>
</li>
<li>
<p>Needs to be a fresh install each time for the dev container because the gui works
right after install, however doesn't work when you close and re-open vscode.
possibly a wine / linux / wsl issue</p>
</li>
<li>
<p>Keep install files for now because deleting them seems to cause an error - I suspect
some kind of race condition where the file is deleted before install is complete.</p>
</li>
<li>
<p>Other references: https://github.com/python-poetry/poetry/issues/5037</p>
</li>
<li>
<p>Install MT5</p>
</li>
</ul>
<div class="no-copy codehilite"><pre><span></span><code><span class="c1"># Installing wine python</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;installing wine python&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>https://www.python.org/ftp/python/<span class="si">${</span><span class="nv">PY_V</span><span class="si">}</span>/python-<span class="si">${</span><span class="nv">PY_V</span><span class="si">}</span>-amd64.exe<span class="w"> </span><span class="se">\</span>
<span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>python-<span class="si">${</span><span class="nv">PY_V</span><span class="si">}</span>-amd64.exe<span class="w"> </span>/quiet<span class="w"> </span><span class="nv">InstallAllUsers</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">PrependPath</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">Include_test</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
<span class="c1"># &amp;&amp; rm python-${PY_V}-amd64.exe \</span>
<span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Python installed successfully&quot;</span>

<span class="c1"># Installing wine python packages</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;installing python packages&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>poetry<span class="w"> </span><span class="se">\</span>
<span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>poetry<span class="w"> </span>config<span class="w"> </span>virtualenvs.create<span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
<span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>poetry<span class="w"> </span>config<span class="w"> </span>virtualenvs.in-project<span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
<span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>poetry<span class="w"> </span>install<span class="w"> </span>--only<span class="w"> </span>mt5

<span class="c1"># Installing MT5</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installing MT5&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>https://download.mql5.com/cdn/web/metaquotes.software.corp/mt5/mt5setup.exe<span class="w"> </span><span class="se">\</span>
<span class="o">&amp;&amp;</span><span class="w"> </span>wine<span class="w"> </span>mt5setup.exe<span class="w"> </span>/auto<span class="w"> </span><span class="se">\</span>
<span class="c1"># &amp;&amp; rm mt5setup.exe \</span>
<span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;MT5 installed successfully&quot;</span>

<span class="k">fi</span>
</code></pre></div>

<h3 id="side-notes">Side notes<a class="headerlink" href="#side-notes" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.tensorflow.org/install/pip">Future versions of tensorflow</a> should be installed like this:</li>
</ul>
<div class="codehilite"><pre><span></span><code>    conda install -c conda-forge cudatoolkit=11.8.0
    python3 -m pip install nvidia-cudnn-cu11==8.6.0.163 tensorflow==2.13.0
    mkdir -p $CONDA_PREFIX/etc/conda/activate.d
    echo &#39;CUDNN_PATH=$(dirname $(python -c &quot;import nvidia.cudnn;print(nvidia.cudnn.__file__)&quot;))&#39; &gt;&gt; $CONDA_PREFIX/etc/conda/activate.d/env_vars.sh
    echo &#39;export LD_LIBRARY_PATH=$CUDNN_PATH/lib:$CONDA_PREFIX/lib/:$LD_LIBRARY_PATH&#39; &gt;&gt; $CONDA_PREFIX/etc/conda/activate.d/env_vars.sh
    source $CONDA_PREFIX/etc/conda/activate.d/env_vars.sh
</code></pre></div>

<ul>
<li>start aerospike - may leave this for later because we may want to put aerospike
configs into the folder of each agent / experiment</li>
</ul>
<div class="codehilite"><pre><span></span><code>start aerospike
asd --config-file ./infrastructure/aerospike.conf
</code></pre></div>

<h2 id="building-the-container">Building the Container<a class="headerlink" href="#building-the-container" title="Permanent link">&para;</a></h2>
<p>Using the repo folder as your context / current working directory, the DockerFile can be built by the following command.</p>
<div class="codehilite"><pre><span></span><code>docker build -t releat -f ./infrastructure/releat/Dockerfile .
</code></pre></div>

<h2 id="running-the-container">Running the Container<a class="headerlink" href="#running-the-container" title="Permanent link">&para;</a></h2>
<p>This container can be used for development in 2 main ways:</p>
<ul>
<li>
<p>VSCode's devcontainer functionality</p>
</li>
<li>
<p>docker container with a mount</p>
</li>
</ul>
<h3 id="vscode-devcontainer">VSCode devcontainer<a class="headerlink" href="#vscode-devcontainer" title="Permanent link">&para;</a></h3>
<p>If you use VSCode as your IDE, you can use the Dev Container extension, using the provided specification in the <code>.devcontainer</code> folder. See the <a href="https://code.visualstudio.com/docs/devcontainers/tutorial">official guide</a> on how to start it up.</p>
<ul>
<li>
<p>Note that in the <code>.devcontainer/devcontainer.json</code>, we invoke the entrypoint script after the docker image has been started up to install the project and MetaTrader5</p>
</li>
<li>
<p>Upon first open, you need to click autotrading + click add account in order for MT5 to connect to servers, otherwise it just hangs</p>
</li>
<li>
<p>If the wine gui is frozen or you can't click on buttons or resizing windows causes distortion, restart your linux or wsl machine or container</p>
</li>
</ul>
<p>Side Notes:</p>
<ul>
<li>Future low priority work to make it more stable: If Developing on Windows system via WSL, to pass through Metatrader GUI, follow <a href="https://kenny.yeoyou.net/it/2020/09/10/windows-development-environment.html">this guide</a> and <a href="https://stackoverflow.com/questions/61110603/how-to-set-up-working-x11-forwarding-on-wsl2/63092879#63092879">this discussion</a></li>
</ul>
<h3 id="docker-run">docker run<a class="headerlink" href="#docker-run" title="Permanent link">&para;</a></h3>
<p>Assumes your context / current working directory is the repo folder. We can build the docker image by:</p>
<div class="no-copy codehilite"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--net<span class="w"> </span>host<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>/tmp/.X11-unix:/tmp/.X11-unix<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/releat<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>DISPLAY<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-it<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>releat<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--gpus<span class="o">=</span>all<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>releat215/releat:1.0<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-c<span class="w"> </span><span class="s1">&#39;./releat/infrastructure/releat/entrypoint.sh &amp;&amp; cd releat &amp;&amp; /bin/bash&#39;</span>
</code></pre></div>

<ul>
<li>
<p><code>--net host</code> container shares network with the host, meaning we don't need to manually listen to ports - i think this also allows the container to access the internet</p>
</li>
<li>
<p><code>-v /tmp/.X11-unix:/tmp/.X11-unix</code> passes through the display. Necessary because MT5 can't be run headlessly (without lots of tinkering)</p>
</li>
<li>
<p><code>-v $(pwd):/releat</code> mounts</p>
</li>
<li>
<p><code>-e DISPLAY</code> Maybe its necessary to pass through the display</p>
</li>
<li>
<p><code>-v $(pwd):/releat</code> mounts the repo to the corresponding location in the container</p>
</li>
<li>
<p><code>--gpus=all</code> passes through GPUs from your machine to the container</p>
</li>
<li>
<p>Still need add in code that binds the location of the repo / fix this docker run code</p>
</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; releat215@gmail.com

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.instant", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "toc.follow"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>